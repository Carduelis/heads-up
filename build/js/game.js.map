{"version":3,"sources":["js/game.js"],"names":["Data","View","EntryPoint","Marionette","extend","initialize","this","triggerMethod","onGetDictionary","_this","localStorage","getItem","$","get","success","dictionary","onDictionaryStored","getOption","length","pickedWords","getRandomWord","i","theWord","view","Game","Main","dataset","app","rootView","getRegion","show","childviewEvents","correct","next","onPassWord","console","log","set","model","onCorrectWord","onNext","e","a","b","Backbone","Model","defaults","word","undefined","History","Collection","template","className","options","_this2","_","delay","accelerometerModelEvents","templateContext","base","width","document","k","delta","size","triggers","click [data-action=\"pass\"]","onGravityChange","z","accelerateTilt","Math","abs","tilt","onDisableButtons","attr","onPass","$el","onStartSwipeAnimation","_this3","addClass","onCorrect","window"],"mappings":"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","file":"game.js","sourcesContent":["(function(){\r\nvar Data = {}, View = {};\r\n\r\n\r\nEntryPoint = Marionette.Object.extend({\r\n\tinitialize: function() {\r\n\t\tthis.triggerMethod('get:dictionary');\r\n\t},\r\n\tonGetDictionary: function() {\r\n\t\tif(localStorage.getItem('dictionary')) {\r\n\r\n\t\t\tthis.triggerMethod('dictionary:stored')\r\n\t\t} else {\r\n\t\t\t$.get('assets/great_noun_list.json').success(dictionary => {\r\n\t\t\t\tthis.dictionary = dictionary;\r\n\t\t\t\tthis.triggerMethod('dictionary:stored', dictionary)\r\n\t\t\t});\r\n\r\n\t\t}\r\n\t},\r\n\tonDictionaryStored: function(dictionary) {\r\n\t\tvar dictionary = this.getOption('dictionary');\r\n\t\tvar length = dictionary.length;\r\n\t\tvar pickedWords = [];\r\n\t\tgetRandomWord = function() {\r\n\t\t\tvar i = _.random(0,length-1);\r\n\t\t\treturn dictionary[i]\r\n\t\t}\r\n\t\tvar theWord = getRandomWord();\r\n\t\tpickedWords.push(theWord);\r\n\r\n\t\tthis.view = new Game.View.Main({\r\n\t\t\tdataset: {\r\n\t\t\t\tword: theWord\r\n\t\t\t}\r\n\t\t})\r\n\t\tapp.rootView.getRegion('content').show(this.view);\r\n\t\tthis.bindEvents(this.view,this.childviewEvents);\r\n\t},\r\n\tchildviewEvents: {\r\n\t\t'pass' \t\t:\t'onPassWord',\r\n\t\t'correct'\t:\t'onCorrectWord',\r\n\t\t'next'\t\t:\t'onNext' \t\r\n\t},\r\n\tonPassWord: function(view) {\r\n\r\n\t\tconsole.log(view);\r\n\t\tview.model.set('guessed',false);\r\n\t\tapp.history.push(view.model);\r\n\t},\r\n\tonCorrectWord: function(view) {\r\n\t\tconsole.log(view);\r\n\t\tview.model.set('guessed',true);\r\n\t\tapp.history.push(view.model);\r\n\t},\r\n\tonNext: function (e,a,b) {\r\n\t\tthis.triggerMethod('dictionary:stored');\r\n\t}\r\n})\r\n\r\nData.Main = Backbone.Model.extend({\r\n\tdefaults: function() {\r\n\t\treturn {\r\n\t\t\tword: 'Default Word',\r\n\t\t\tguessed: undefined\r\n\t\t}\r\n\t}\r\n});\r\nData.History = Backbone.Collection.extend({\r\n\tmodel: Data.Main,\r\n\tinitialize: function() {\r\n\r\n\t}\r\n});\r\napp.history = new Data.History();\r\nView.Main = Marionette.View.extend({\r\n\ttemplate: '#t-main',\r\n\tclassName: 'game-content',\r\n\tinitialize: function(options) {\r\n\t\tthis.model = new Data.Main(options.dataset);\r\n\t\t_.delay(()=>{\r\n\t\t\tthis.bindEvents(app.model,this.accelerometerModelEvents);\r\n\t\t},500);\r\n\t},\r\n\ttemplateContext: function() {\r\n\t\tvar length = this.model.get('word').length;\r\n\t\tvar base = 1;\r\n\t\tvar width = $(document).width();\r\n\t\tvar k = width*0.8/length/16\r\n\t\tvar delta = k < 4 ? k : 4; \r\n\t\treturn {\r\n\t\t\tsize: base+delta\r\n\t\t}\r\n\t},\r\n\taccelerometerModelEvents: {\r\n\t\t'change': 'onGravityChange'\r\n\t},\r\n\ttriggers: {\r\n\t\t'click [data-action=\"correct\"]': 'correct',\r\n\t\t'click [data-action=\"pass\"]': 'pass',\r\n\t},\r\n\tonGravityChange: function(model) {\r\n\t\tvar tilt = model.get('gravity').z;\r\n\t\tvar accelerateTilt = model.get('z');\r\n\t\tif (Math.abs(tilt) < 4) {\r\n\t\t\t// ok-state\r\n\t\t} else if (Math.abs(tilt) < 6) {\r\n\t\t\t// warning-state\r\n\t\t}\r\n\t\tif (tilt < -4 && accelerateTilt > 0.8) {\r\n\t\t\tthis.unbindEvents(app.model,this.accelerometerModelEvents);\r\n\t\t\tthis.triggerMethod('correct',this);\r\n\t\t}\r\n\t\tif (tilt > 6 && accelerateTilt < -0.8) {\r\n\t\t\tthis.unbindEvents(app.model,this.accelerometerModelEvents);\r\n\t\t\tthis.triggerMethod('pass',this);\r\n\t\t}\r\n\t},\r\n\tonDisableButtons: function () {\r\n\t\tthis.$el.find('[data-action]').attr('disabled','disabled');\t\r\n\t},\r\n\tonPass: function() {\r\n\t\tthis.triggerMethod('disable:buttons');\r\n\t\tthis.$el.addClass('pass');\r\n\t\tthis.triggerMethod('start:swipe:animation');\r\n\t},\r\n\tonStartSwipeAnimation: function () {\r\n\t\t_.delay(()=>{\r\n\t\t\tthis.$el.addClass('swiped');\r\n\t\t\t_.delay(()=>{\r\n\t\t\t\tthis.triggerMethod('next');\r\n\t\t\t},300);\r\n\t\t},300);\r\n\t},\r\n\tonCorrect: function() {\r\n\t\tthis.triggerMethod('disable:buttons');\r\n\t\tthis.$el.addClass('correct');\r\n\t\tthis.triggerMethod('start:swipe:animation');\r\n\t},\r\n})\r\n\r\nwindow.Game = {\r\n\tView: View,\r\n\tData: Data,\r\n\tEntry: EntryPoint\r\n}\r\n\r\n}());"]}