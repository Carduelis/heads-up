function _defineProperty(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}!function(){var t={},e={};EntryPoint=Marionette.Object.extend({initialize:function(){this.dictionaryName=Dictionary.choosed.getName(),localRead("dictionaryName")===this.dictionaryName?this.triggerMethod("dictionary:stored",localRead("dictionary")):this.triggerMethod("load:dictionary")},onLoadDictionary:function(){var t=this;console.log("onLoadDictionary"),$.get("assets/dictionaries/"+this.dictionaryName+".json").success(function(e){t.triggerMethod("dictionary:stored",e),t.storeDictionary(e)}).error(function(t){alert("Sorry, can't reach the dictionary. Try again or pick another one")})},storeDictionary:function(t){console.log("storeDictionary"),localSave("dictionaryName",this.dictionaryName),localSave("dictionary",t)},pickWord:function(){for(var t=this.getOption("dictionary"),e=this.getOption("pickedWords"),i=t.length,o=_.random(0,i-1);"undefined"!=typeof e[o];)o=_.random(0,i-1);return e[o]=t[o],t[o]},onDictionaryStored:function(t){console.log("onDictionaryStored"),this.dictionary=t,this.pickedWords={},this.triggerMethod("show:word")},onShowWord:function(){this.view=new Game.View.Main({dataset:{word:this.pickWord()}}),app.rootView.getRegion("content").show(this.view),this.bindEvents(this.view,this.childviewEvents)},childviewEvents:{pass:"onPassWord",correct:"onCorrectWord",next:"onNext"},onPassWord:function(t){console.log(t),t.model.set("guessed",!1),app.history.push(t.model)},onCorrectWord:function(t){console.log(t),t.model.set("guessed",!0),app.history.push(t.model)},onNext:function(t,e,i){app.timer.view.model.get("time")>0&&this.triggerMethod("show:word")}}),t.Main=Backbone.Model.extend({defaults:function(){return{word:"Default Word",guessed:void 0}}}),t.History=Backbone.Collection.extend({model:t.Main,initialize:function(){}}),app.history=new t.History,e.Main=Marionette.View.extend({template:"#t-main",className:"game-content",initialize:function(e){var i=this;this.model=new t.Main(e.dataset),_.delay(function(){i.bindEvents(app.model,i.accelerometerModelEvents)},500),_.delay(function(){i.triggerMethod("vibra")},1500),this.triggerMethod("get:info")},onGetInfo:function(){var t=this;$.get("http://api.pearson.com/v2/dictionaries/ldoce5/entries?headword="+this.model.get("word")).success(function(e){t.triggerMethod("render:info",e)})},onRenderInfo:function(t){if(200==t.status)try{this.$el.find(".info").html("may be a <b>"+t.results[0].part_of_speech+"</b>")}catch(t){this.$el.find(".info").text("not found"),console.error(t)}},onDestroy:function(){this.unbindEvents(app.model,this.accelerometerModelEvents),this.doNotVibrate=!0,stopVibrate()},onVibra:function(){var t=this;if(stopVibrate(),this.getOption("doNotVibrate")!==!0){var e=app.model.get("gravity").z,i=Math.abs(e)-3;Math.abs(e)<6&&Math.abs(e)>3&&(delay=300-100*i,delay=100,duration=10+10*i,duration=duration>50?50:duration,startPeristentVibrate(duration,delay)),_.delay(function(){t.triggerMethod("vibra")},300)}},templateContext:function(){var t=this.model.get("word").length,e=1,i=$(document).width(),o=.8*i/t/16,n=o<3?o:3;return{size:e+n}},accelerometerModelEvents:{change:"onGravityChange"},triggers:{'click [data-action="correct"]':"correct",'click [data-action="pass"]':"pass"},onGravityChange:function(t){var e,i=t.get("gravity").z,o=t.get("z"),n=(e={vertical:Math.abs(i)<3,warningVertical:Math.abs(i)<6&&Math.abs(i)>3,wordCorrect:i<-6&&o>.8,wordIncorrect:i>6&&o<-.8},_defineProperty(e,"wordCorrect",i<-6&&o<-4),_defineProperty(e,"wordIncorrect",i>6&&o>4),e);$('h2[data-action="navigate"]').html('<span class="tilt">'+i.toFixed(2)+'</span><span class="tilt-acc">'+o.toFixed(2)+"</span>"),n.vertical&&this.triggerMethod("normal:state"),n.wordCorrect&&(this.triggerMethod("normal:state"),this.triggerMethod("correct",this)),n.wordIncorrect&&(this.triggerMethod("normal:state"),this.triggerMethod("pass",this)),n.warningVertical&&this.triggerMethod("warning:state",i)},onNormalState:function(){this.$el.removeClass("warning"),console.log("normal:state"),stopVibrate()},onWarningState:function(t){console.log("warning:state"),this.$el.addClass("warning")},onStartSwipeAnimation:function(){var t=this;_.delay(function(){t.$el.addClass("swiped"),_.delay(function(){t.triggerMethod("next")},300)},300)},onDisableGuessing:function(){this.unbindEvents(app.model,this.accelerometerModelEvents),this.$el.find("[data-action]").attr("disabled","disabled"),this.doNotVibrate=!0},onPass:function(){playSound("wrong"),this.$el.addClass("pass"),this.triggerMethod("disable:guessing"),this.triggerMethod("start:swipe:animation")},onBeforeWordDissapearing:function(){},onPrev:function(){prevWordModel=app.history.last()},onCorrect:function(){playSound("correct"),this.$el.addClass("correct"),this.triggerMethod("disable:guessing"),this.triggerMethod("start:swipe:animation")}}),window.Game={View:e,Data:t,Entry:EntryPoint}}();
//# sourceMappingURL=game.js.map
