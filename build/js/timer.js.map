{"version":3,"sources":["js/timer.js"],"names":["Data","View","EntryPoint","Marionette","extend","initialize","settings","localRead","time","_","title","this","view","model","Backbone","app","getRegion","show","template","options","className","regions","RegionSetter","triggerMethod","modelEvents","change:time","change","onDecreaseTime","_this","get","delay","router","navigate","timeToSeconds","minutes","Math","seconds","timeToMinutes","onRender","templateContext","window","Entry"],"mappings":"CAAC,WACD,GAAAA,MAAAC,IAGAC,YAAAA,WAAaC,OAAAC,QACZC,WAAAA,WACC,GAAAC,GAAIA,UAAWC,WAEfC,MAAAA,EAAOC,KAAAH,GAAiBI,MAACA,mBACzBC,KAAAC,KAAA,GAAYX,GAAIA,OACfY,MAAAA,GAAOC,UAAIA,OACVN,KAAM,GAANA,KAAMA,UAGRO,IAAAA,SAAAC,UAAA,UAAAC,KAAAN,KAAsCC,QAM3BM,YAASjB,KAAAG,QACrBC,SAAAA,EAAAA,SAAY,gBACXA,WAAA,SAAac,GACbR,KAAAE,MAAAM,EAAAN,SAGWK,WAASjB,KAAAG,QACrBC,SAAAA,EAAAA,SAAY,gBACXA,WAAA,SAAac,GACbR,KAAAE,MAAAM,EAAAN,QAIDK,GAAAA,MAAUf,WADyBF,KAAAG,QAEnCgB,SAAAA,WACAC,UAAS,QACThB,QAAAA,GAAYiB,cAAA,UAASH,WACpBd,WAAKkB,SAAcJ,GACnBR,KANkCY,cAAA,kBAQlCC,aACAC,cAAW,iBAFCC,OAPsB,UAWRC,eAAA,WAAA,GAAAC,GAAAjB,KACtBH,EAAOG,KAAKE,MAAMgB,IAAI,OAA1BrB,GAAIA,EACJC,EAAAqB,MAAItB,WACHC,GAAQ,EACPD,EAAAA,MAAOA,IAAO,OAAdA,IACA,KAIDO,IAAIgB,OAAOC,SAAS,WAApBjB,SAAIgB,KAILE,cAxBkC,WAyBnCA,GAAAA,GAAAA,KAAepB,MAAAgB,IAAA,QACdK,EAAWC,KAAKtB,MAAMgB,EAAI,GAKzB,OAJDO,SAAIF,EAAqB1B,GAAX2B,EACdC,QAAU5B,KACV4B,QAAIA,IAAUA,SAEbA,SAEDC,cAjCkC,WAkCnCA,GAAAA,GAAAA,KAAgBxB,MAAAgB,IAAA,QACfK,EAAWC,KAAKtB,MAAMgB,EAAI,GAKzB,OAJDO,SAAIF,EAAqB1B,GAAX2B,EACdC,EAAU5B,KACV0B,EAAIA,IAAUA,GAEbA,GAEDI,SA1CkC,aA6CnCC,gBAAAA,WACC,OACCH,QAAYzB,KAAKsB,gBACjBC,QAAYvB,KAAK0B,oBAKpBG,OAAAA,OACCvC,KAAAA,EACAD,KAAAA,EACAyC,MAAAA","file":"timer.js","sourcesContent":["(function(){\r\nvar Data = {}, View = {};\r\n\r\n\r\nEntryPoint = Marionette.Object.extend({\r\n\tinitialize: function() {\r\n\t\tvar settings = localRead('settings');\r\n\t\tvar dataset = {};\r\n\t\ttime = _.find(settings, {title: 'Время на раунд'});\r\n\t\tthis.view = new View.Timer({\r\n\t\t\tmodel: new Backbone.Model({\r\n\t\t\t\ttime: time.value*10\r\n\t\t\t})\r\n\t\t});\r\n\t\tapp.rootView.getRegion('footer').show(this.view);\r\n\t},\r\n});\r\n\r\n\r\nvar Minutes = Marionette.View.extend({\r\n\ttemplate: _.template('<%-minutes%>'),\r\n\tinitialize: function(options) {\r\n\t\tthis.model = options.model\r\n\t}\r\n});\r\nvar Seconds = Marionette.View.extend({\r\n\ttemplate: _.template('<%-seconds%>'),\r\n\tinitialize: function(options) {\r\n\t\tthis.model = options.model\r\n\t}\r\n});\r\n\r\nView.Timer = Marionette.View.extend({\r\n\ttemplate: '#t-timer',\r\n\tclassName: 'timer',\r\n\tregions: new RegionSetter('minutes','seconds'),\r\n\tinitialize: function(options) {\r\n\t\tthis.triggerMethod('decrease:time');\r\n\t},\r\n\tmodelEvents: {\r\n\t\t'change:time' : 'onDecreaseTime',\r\n\t\t'change'\t: 'render'\r\n\t},\r\n\tonDecreaseTime: function() {\r\n\t\tvar time = this.model.get('time');\r\n\t\tif (time > 0) {\r\n\t\t\t_.delay(()=>{\r\n\t\t\t\ttime = time - 1;\r\n\t\t\t\tthis.model.set('time',time);\r\n\t\t\t},1000)\r\n\t\t} else {\r\n\t\t\t\r\n\t\t\tapp.router.navigate('results',{\r\n\t\t\t\ttrigger: true\r\n\t\t\t});\r\n\t\t}\r\n\t},\r\n\ttimeToSeconds: function () {\r\n\t\tvar time = this.model.get('time');\r\n\t\tvar minutes = Math.floor(time / 60);\r\n\t\tseconds = time - minutes * 60;\r\n\t\tif (seconds < 10) {\r\n\t\t\tseconds = '0'+seconds;\r\n\t\t}\r\n\t\treturn seconds\r\n\t},\r\n\ttimeToMinutes : function() {\r\n\t\tvar time = this.model.get('time');\r\n\t\tvar minutes = Math.floor(time / 60);\r\n\t\tseconds = time - minutes * 60;\r\n\t\tif (minutes < 10) {\r\n\t\t\tminutes = '0'+minutes;\r\n\t\t}\r\n\t\treturn minutes\r\n\t},\r\n\tonRender: function() {\r\n\t},\r\n\ttemplateContext: function() {\r\n\t\treturn {\r\n\t\t\t'seconds' : this.timeToSeconds(),\r\n\t\t\t'minutes' : this.timeToMinutes(),\r\n\t\t}\r\n\t}\r\n});\r\n\r\nwindow.Timer = {\r\n\tView: View,\r\n\tData: Data,\r\n\tEntry: EntryPoint\r\n}\r\n\r\n}());"]}