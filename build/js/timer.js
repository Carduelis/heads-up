!function(){var e={},t={},i=Marionette.Object.extend({model:new Backbone.Model,initialize:function(e){var t=localRead("settings"),i=_.find(t,{title:"Время на раунд"});i?this.model.set("time",60*i.value*1e3):this.model.set("time",6e4),this.triggerMethod("start")},onStart:function(){this.model.set("startTime",this.model.get("time")),this.pause=!1,this.triggerMethod("tick")},onAfterTick:function(){},onDestroy:function(){this.pause=!0},onStop:function(){console.log("stop"),this.model.set("time",this.model.get("startTime")),this.pause=!0;this.model.get("time")},onPause:function(){this.pause=!0},onPlay:function(){this.pause=!1,this.triggerMethod("tick")},onTick:function(e){var t=this;this.triggerMethod("before:tick");var e=e||1e3;this.model.set("time",this.model.get("time")-e),this.model.get("time")>0?this.pause||_.delay(function(){t.triggerMethod("tick",e)},e):this.triggerMethod("end"),this.triggerMethod("after:tick")}}),o=Marionette.Object.extend({initialize:function(){this.view=new t.Timer,app.rootView.getRegion("footer").show(this.view)}});t.Timer=Marionette.View.extend({template:"#t-timer",className:"timer",initialize:function(e){this.timer=new i({tick:1e3}),this.model=this.timer.model},modelEvents:{change:"render"},triggers:{'click [data-action="pause"]':"pause"},onPause:function(){console.log(this.timer.pause),this.timer.pause?this.timer.triggerMethod("play"):this.timer.triggerMethod("pause")},onDestroy:function(){this.timer.triggerMethod("destroy")},templateContext:function(){var e=this.model.get("time"),t=Math.floor(e/60/1e3),i=Math.floor((e-60*t*1e3)/1e3);return t<10&&(t="0"+t),i<10&&(i="0"+i),{minutes:t,seconds:i,isPause:this.timer.pause}},onScaled:function(){var e=this;console.log("scaled");var t=300,i=1e3,o=(i-2*t)/2;_.delay(function(){e.$el.toggleClass("scaled"),_.delay(function(){e.$el.toggleClass("scaled")},o)},t)},onHighlight:function(){var e=this;_.delay(function(){e.$el.addClass("highlight")},200)},onBeforeRender:function(){var e=this;0==this.model.get("time")&&(_.delay(function(){e.$el.addClass("time-is-up")},100),_.delay(function(){e.$el.addClass("bound-out")},1100),_.delay(function(){app.router.navigate("results",{trigger:!0})},1500)),1e4===this.model.get("time")&&this.triggerMethod("highlight"),this.model.get("time")<4e3&&this.triggerMethod("highlight")},onRender:function(){console.log("render")}}),window.Timer={View:t,Data:e,Entry:o}}();
//# sourceMappingURL=timer.js.map
