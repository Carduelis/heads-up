{"version":3,"sources":["js/setup.js"],"names":["Data","View","dataset","type","name","disabledState","value","measure","options","id","initialize","localSave","view","EntryPoint","Marionette","Object","extend","this","SettingsWrapper","Setting","getRegion","Model","Backbone","description","Settings","template","Collection","className","lsChannel","onDestroy","RegionSetter","console","warn","off","render","settingListView","localRead","onRender","show","SettingItem","onInput","input .form-control","change .form-control[type=\"checkbox\"]","model","e","trigger","set","currentTarget","tagName","checked","attributes","collection","bindEvents","childView","collectionEvents","log","accelerometerModelEvents","onModelChange","change","x","y","get","abs","models","transform","Math","$el","css","window","Setup","Entry"],"mappings":"CAAC,WACD,GAAAA,MAAAC,KAGAC,IAGEC,MAAM,oBACNC,KAAM,SACNC,KAAAA,QACAC,cAAO,WANKA,MAOX,IAEDH,MAAM,iBACNG,KAAAA,SACAF,MAAM,EACNC,KAAAA,OACAE,eAAS,EAbGA,QAcX,QAEDJ,MAAM,OACNG,KAAAA,WACAD,OAAAA,EACAD,eAAM,EAnBMA,KAoBX,UAEDC,MAAAA,YACAD,cAAM,WACND,KAAM,WACNG,KAAAA,SACAE,MAAAA,EAEEC,UAFOA,GAIN,EACDA,KADC,gBAJMA,GAON,EACDA,KADC,qCAPMA,GAUN,EACDA,KADC,qBAVMA,GAAA,EA1BXL,KAAA,aA+CCM,UAAY,aACXC,UAAKC,WAAWX,GAEhBY,WAAAC,WAAAC,OAAAC,QAJoCN,WAAtC,WAEEO,KAAKL,KAAO,GAAIX,GAAKiB,gBAKvBlB,IAAKmB,SAALC,UAAwBC,WAAML,KAAOC,KAAAL,SAIlCT,EAAAA,QAAMmB,SAFAD,MAAAL,QAGNO,SAAAA,WACAf,OACAD,MAAAA,sBACAF,KAAAA,OACAC,YAAO,KAPDE,QAAP,KASAD,QAAA,KAXFF,cAAA,WAaAL,MAAKwB,SAIJC,EAAAA,SAAUH,SADmCI,WAAAV,QAE7CW,MAAAA,EAAWR,UAEXT,EAAAA,gBAAYI,WAASN,KAAAA,QACpBoB,SAAAA,WAEAD,UAP4C,wBAQ7CE,QAAAA,GAAWC,cAAA,QACVC,WAAQC,SAARxB,GACAoB,UAAAA,GAAUK,qBAAVhB,KAAAiB,SAGAL,UAAIM,WACHjC,QAAAA,KAASkC,OAD8BR,UAAxCK,IAAA,uBAIAI,SAAA,WAjBqB,GAAvBF,GAAA,GAAAlC,GAAAuB,UAcGtB,QAASkC,UAAU,aAOrBX,MAAAA,UAAU,QAAAa,KAD+BH,MAKxClC,EAAAsC,YAAAzB,WAAAb,KAAAe,QAFOS,SAHiC,kBAOzCe,UAAS,qCACRT,QACAU,sBAAA,UACAC,wCAVwC,YAYxCF,QAAKG,SAAUC,GACfhB,QAAAA,IAAUiB,EAAAA,cAAQvC,OAClBW,KAAA0B,MAAAG,IAAA,QAAAF,EAAAG,cAAAzC,QAEFL,SAAKuB,SAAWV,GACfkC,KAAAA,MAASF,IADuC,QAAAF,EAAAG,cAAAE,SAEhDtB,UAAAA,QAAW,qBAFqCV,KAAA0B,MAAAO,eAK/CjD,EAAAuB,SAAK2B,WAAiBnD,eAAcQ,QACpCuB,QAAAA,KACAJ,UAAKyB,yBACLC,UAR+CpD,EAAAsC,YAShDe,WAAAA,SAAkB9C,GACjBS,KAAAkC,WAAW,GAAAnD,GAAAwB,SAAAhB,EAAAN,SADM6B,QAT8BwB,IAAAtC,KAAAkC,YAYhDK,KAAAA,WAAAA,IAAAA,MAA0BvC,KAAAuC,2BAAAF,kBAG1BG,OAAAA,iBAEC9C,0BACA+C,OAlB+C,mBAoB/CC,cAAI,WACJC,QAAIjB,IAAMkB,SACVlD,UAASmD,WAAS7C,KAAdkC,WAAsBY,SAExBC,gBAAW,SAAArB,GADCgB,EAAb,EAAAhB,EAAAkB,IAAA,WAAAF,EAAA,EAKAC,EAAA,GAAAjB,EAAAkB,IAAA,WAAAD,EAAA,EACDK,KAAAH,IAAAH,GAAA,GAAA,GAAAM,KAAAH,IAAAF,GAAA,MANC3C,KAAKiD,IAAIC,KAvBZH,UAAA,eAAAL,EAAA,OAAAC,EAAA,aAiCAQ,OAAOC,OACNpE,KAAMA,EACND,KAAMA,EACNsE,MAAOzD","file":"setup.js","sourcesContent":["(function(){\r\nvar Data = {}, View = {};\r\n\r\n\r\nvar dataset = [\r\n\t{\r\n\t\ttitle: 'Количество команд',\r\n\t\ttype: 'number',\r\n\t\tname: 'teams',\r\n\t\tdisabledState: 'disabled',\r\n\t\tvalue: 2\r\n\t},{\r\n\t\ttitle: 'Время на раунд',\r\n\t\ttype: 'number',\r\n\t\tvalue: 1,\r\n\t\tname: 'time',\r\n\t\tdisabledState: false,\r\n\t\tmeasure: 'мин'\r\n\t},{\r\n\t\ttitle: 'Звук',\r\n\t\ttype: 'checkbox',\r\n\t\tvalue: true,\r\n\t\tdisabledState: false,\r\n\t\tname: 'sound',\r\n\t},{\r\n\t\ttitle: 'Категория',\r\n\t\tdisabledState: 'disabled',\r\n\t\tname: 'category',\r\n\t\ttype: 'select',\r\n\t\tvalue: 1,\r\n\t\toptions: [\r\n\t\t\t{\r\n\t\t\t\tid: 1,\r\n\t\t\t\tname: 'Общие слова'\r\n\t\t\t},{\r\n\t\t\t\tid: 2,\r\n\t\t\t\tname: 'Музыкальные группы и исполнители'\r\n\t\t\t},{\r\n\t\t\t\tid: 3,\r\n\t\t\t\tname: 'Продукты питания'\r\n\t\t\t},{\r\n\t\t\t\tid: 4,\r\n\t\t\t\tname: 'Гаджеты'\r\n\t\t\t}\r\n\t\t]\r\n\t}\r\n];\r\nif (!localHas('settings')) {\r\n\tlocalSave('settings',dataset);\r\n}\r\nEntryPoint = Marionette.Object.extend({\r\n\tinitialize: function() {\r\n\t\tthis.view = new View.SettingsWrapper();\r\n\t\tapp.rootView.getRegion('content').show(this.view);\r\n\t},\r\n});\r\n\r\nData.Setting = Backbone.Model.extend({\r\n\tdefaults: function() {\r\n\t\treturn {\r\n\t\t\ttitle: 'Заголовок настройки',\r\n\t\t\ttype: 'text',\r\n\t\t\tdescription: null,\r\n\t\t\toptions: null,\r\n\t\t\tmeasure: null,\r\n\t\t\tdisabledState: 'disabled',\r\n\t\t\tvalue: null,\r\n\t\t}\r\n\t}\r\n});\r\nData.Settings = Backbone.Collection.extend({\r\n\tmodel: Data.Setting,\r\n});\r\nView.SettingsWrapper = Marionette.View.extend({\r\n\ttemplate: '#t-setup',\r\n\tclassName: 'container navibar-pad',\r\n\tregions: new RegionSetter('list'),\r\n\tinitialize: function(options) {\r\n\t\tlsChannel.on('sound:save:success', this.render);\r\n\t\t\r\n\t},\r\n\tonDestroy: function() {\r\n\t\tconsole.warn('kek');\r\n\t\tlsChannel.off('sound:save:success');\r\n\t},\r\n\tonRender: function() {\r\n\t\tvar settingListView = new View.Settings({\r\n\t\t\tdataset: localRead('settings')\r\n\t\t});\r\n\t\tthis.getRegion('list').show(settingListView)\r\n\t}\r\n});\r\n\r\nView.SettingItem = Marionette.View.extend({\r\n\ttemplate: '#t-setting-item',\r\n\tclassName: 'list-group-item list-settings-item',\r\n\tevents: {\r\n\t\t'input .form-control': 'onInput',\r\n\t\t'change .form-control[type=\"checkbox\"]': 'onChange',\r\n\t},\r\n\tonInput: function(e) {\r\n\t\tconsole.log(e.currentTarget.value);\r\n\t\tthis.model.set('value',e.currentTarget.value);\r\n\t},\r\n\tonChange: function(e) {\r\n\t\tthis.model.set('value',e.currentTarget.checked);\r\n\t\tlsChannel.trigger('setup:save:success',this.model.attributes);\r\n\t}\r\n});\r\nView.Settings = Marionette.CollectionView.extend({\r\n\ttagName: 'ul',\r\n\tclassName: 'list-group navibar-pad',\r\n\tchildView: View.SettingItem,\r\n\tinitialize: function (options) {\r\n\t\tthis.collection = new Data.Settings(options.dataset);\r\n\t\tconsole.log(this.collection);\r\n\t\tthis.bindEvents(app.model,this.accelerometerModelEvents);\r\n\t},\r\n\tcollectionEvents: {\r\n\t\t'change' : 'onModelChange'\r\n\t},\r\n\taccelerometerModelEvents: {\r\n\t\t'change' : 'onGravityChange'\r\n\t},\r\n\tonModelChange: function() {\r\n\t\tconsole.log('saved')\r\n\t\tlocalSave('settings',this.collection.models);\r\n\t},\r\n\tonGravityChange: function(model) {\r\n\t\tx = model.get('gravity').x*9/2;\r\n\t\ty = model.get('gravity').y*16/2;\r\n\t\tif (Math.abs(x) > 10/9 && Math.abs(y) > 10/16) {\r\n\t\t\tthis.$el.css({\r\n\t\t\t\ttransform: 'translate3d('+x+'px, '+y+'px,0)',\r\n\t\t\t\t// transform: 'translate3d('+x+'px, '+y+'px,0) rotateX('+y/5+'deg) rotateY('+x/5+'deg)',\r\n\t\t\t\t// transform: 'rotateX('+y+'deg) rotateY('+x+'deg) rotateZ('+x+'deg)',\r\n\t\t\t})\r\n\t\t}\r\n\t}\r\n\r\n});\r\n\r\nwindow.Setup = {\r\n\tView: View,\r\n\tData: Data,\r\n\tEntry: EntryPoint\r\n}\r\n\r\n}());"]}