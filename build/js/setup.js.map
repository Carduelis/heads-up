{"version":3,"sources":["js/setup.js"],"names":["Data","View","dataset","title","type","name","disabledState","value","measure","options","id","localHas","localSave","EntryPoint","Marionette","Object","extend","initialize","this","view","SettingsWrapper","app","rootView","getRegion","show","Setting","Backbone","Model","defaults","description","Settings","Collection","model","template","className","regions","RegionSetter","lsChannel","on","render","onDestroy","console","warn","off","onRender","settingListView","localRead","SettingItem","events","input .form-control","change .form-control","onInput","e","set","currentTarget","onChange","checked","trigger","attributes","CollectionView","tagName","childView","collection","log","bindEvents","accelerometerModelEvents","collectionEvents","change","onModelChange","models","onGravityChange","x","get","y","Math","abs","$el","css","transform","window","Setup","Entry"],"mappings":"CAAC,WACD,GAAIA,MAAWC,KAGXC,IAEFC,MAAO,oBACPC,KAAM,SACNC,KAAM,QACNC,cAAe,WACfC,MAAO,IAEPJ,MAAO,iBACPC,KAAM,SACNG,MAAO,EACPF,KAAM,OACNC,eAAe,EACfE,QAAS,QAETL,MAAO,OACPC,KAAM,WACNG,OAAO,EACPD,eAAe,EACfD,KAAM,UAENF,MAAO,YACPG,cAAe,WACfD,KAAM,WACND,KAAM,SACNG,MAAO,EACPE,UAEEC,GAAI,EACJL,KAAM,gBAENK,GAAI,EACJL,KAAM,qCAENK,GAAI,EACJL,KAAM,qBAENK,GAAI,EACJL,KAAM,aAKLM,UAAS,aACbC,UAAU,WAAWV,GAEtBW,WAAaC,WAAWC,OAAOC,QAC9BC,WAAY,WACXC,KAAKC,KAAO,GAAIlB,GAAKmB,gBACrBC,IAAIC,SAASC,UAAU,WAAWC,KAAKN,KAAKC,SAI9CnB,EAAKyB,QAAUC,SAASC,MAAMX,QAC7BY,SAAU,WACT,OACCzB,MAAO,sBACPC,KAAM,OACNyB,YAAa,KACbpB,QAAS,KACTD,QAAS,KACTF,cAAe,WACfC,MAAO,SAIVP,EAAK8B,SAAWJ,SAASK,WAAWf,QACnCgB,MAAOhC,EAAKyB,UAEbxB,EAAKmB,gBAAkBN,WAAWb,KAAKe,QACtCiB,SAAU,WACVC,UAAW,wBACXC,QAAS,GAAIC,cAAa,QAC1BnB,WAAY,SAASR,GACpB4B,UAAUC,GAAG,qBAAsBpB,KAAKqB,SAGzCC,UAAW,WACVC,QAAQC,KAAK,OACbL,UAAUM,IAAI,uBAEfC,SAAU,WACT,GAAIC,GAAkB,GAAI5C,GAAK6B,UAC9B5B,QAAS4C,UAAU,aAEpB5B,MAAKK,UAAU,QAAQC,KAAKqB,MAI9B5C,EAAK8C,YAAcjC,WAAWb,KAAKe,QAClCiB,SAAU,kBACVC,UAAW,qCACXc,QACCC,sBAAuB,UACvBC,uBAAwB,YAEzBC,QAAS,SAASC,GACjBlC,KAAKc,MAAMqB,IAAI,QAAQD,EAAEE,cAAc/C,QAExCgD,SAAU,SAASH,GAClBlC,KAAKc,MAAMqB,IAAI,QAAQD,EAAEE,cAAcE,SACvCnB,UAAUoB,QAAQ,qBAAqBvC,KAAKc,MAAM0B,eAGpDzD,EAAK6B,SAAWhB,WAAW6C,eAAe3C,QACzC4C,QAAS,KACT1B,UAAW,yBACX2B,UAAW5D,EAAK8C,YAChB9B,WAAY,SAAUR,GACrBS,KAAK4C,WAAa,GAAI9D,GAAK8B,SAASrB,EAAQP,SAC5CuC,QAAQsB,IAAI7C,KAAK4C,YACjB5C,KAAK8C,WAAW3C,IAAIW,MAAMd,KAAK+C,2BAEhCC,kBACCC,OAAW,iBAEZF,0BACCE,OAAW,mBAEZC,cAAe,WACd3B,QAAQsB,IAAI,SACZnD,UAAU,WAAWM,KAAK4C,WAAWO,SAEtCC,gBAAiB,SAAStC,GACzBuC,EAA2B,EAAvBvC,EAAMwC,IAAI,WAAWD,EAAI,EAC7BE,EAA2B,GAAvBzC,EAAMwC,IAAI,WAAWC,EAAK,EAC1BC,KAAKC,IAAIJ,GAAK,GAAG,GAAKG,KAAKC,IAAIF,GAAK,MACvCvD,KAAK0D,IAAIC,KACRC,UAAW,eAAeP,EAAE,OAAOE,EAAE,aASzCM,OAAOC,OACN/E,KAAMA,EACND,KAAMA,EACNiF,MAAOpE","file":"js/setup.js","sourcesContent":["(function(){\r\nvar Data = {}, View = {};\r\n\r\n\r\nvar dataset = [\r\n\t{\r\n\t\ttitle: 'Количество команд',\r\n\t\ttype: 'number',\r\n\t\tname: 'teams',\r\n\t\tdisabledState: 'disabled',\r\n\t\tvalue: 2\r\n\t},{\r\n\t\ttitle: 'Время на раунд',\r\n\t\ttype: 'number',\r\n\t\tvalue: 4,\r\n\t\tname: 'time',\r\n\t\tdisabledState: false,\r\n\t\tmeasure: 'мин'\r\n\t},{\r\n\t\ttitle: 'Звук',\r\n\t\ttype: 'checkbox',\r\n\t\tvalue: true,\r\n\t\tdisabledState: false,\r\n\t\tname: 'sound',\r\n\t},{\r\n\t\ttitle: 'Категория',\r\n\t\tdisabledState: 'disabled',\r\n\t\tname: 'category',\r\n\t\ttype: 'select',\r\n\t\tvalue: 1,\r\n\t\toptions: [\r\n\t\t\t{\r\n\t\t\t\tid: 1,\r\n\t\t\t\tname: 'Общие слова'\r\n\t\t\t},{\r\n\t\t\t\tid: 2,\r\n\t\t\t\tname: 'Музыкальные группы и исполнители'\r\n\t\t\t},{\r\n\t\t\t\tid: 3,\r\n\t\t\t\tname: 'Продукты питания'\r\n\t\t\t},{\r\n\t\t\t\tid: 4,\r\n\t\t\t\tname: 'Гаджеты'\r\n\t\t\t}\r\n\t\t]\r\n\t}\r\n];\r\nif (!localHas('settings')) {\r\n\tlocalSave('settings',dataset);\r\n}\r\nEntryPoint = Marionette.Object.extend({\r\n\tinitialize: function() {\r\n\t\tthis.view = new View.SettingsWrapper();\r\n\t\tapp.rootView.getRegion('content').show(this.view);\r\n\t},\r\n});\r\n\r\nData.Setting = Backbone.Model.extend({\r\n\tdefaults: function() {\r\n\t\treturn {\r\n\t\t\ttitle: 'Заголовок настройки',\r\n\t\t\ttype: 'text',\r\n\t\t\tdescription: null,\r\n\t\t\toptions: null,\r\n\t\t\tmeasure: null,\r\n\t\t\tdisabledState: 'disabled',\r\n\t\t\tvalue: null,\r\n\t\t}\r\n\t}\r\n});\r\nData.Settings = Backbone.Collection.extend({\r\n\tmodel: Data.Setting,\r\n});\r\nView.SettingsWrapper = Marionette.View.extend({\r\n\ttemplate: '#t-setup',\r\n\tclassName: 'container navibar-pad',\r\n\tregions: new RegionSetter('list'),\r\n\tinitialize: function(options) {\r\n\t\tlsChannel.on('sound:save:success', this.render);\r\n\t\t\r\n\t},\r\n\tonDestroy: function() {\r\n\t\tconsole.warn('kek');\r\n\t\tlsChannel.off('sound:save:success');\r\n\t},\r\n\tonRender: function() {\r\n\t\tvar settingListView = new View.Settings({\r\n\t\t\tdataset: localRead('settings')\r\n\t\t});\r\n\t\tthis.getRegion('list').show(settingListView)\r\n\t}\r\n});\r\n\r\nView.SettingItem = Marionette.View.extend({\r\n\ttemplate: '#t-setting-item',\r\n\tclassName: 'list-group-item list-settings-item',\r\n\tevents: {\r\n\t\t'input .form-control': 'onInput',\r\n\t\t'change .form-control': 'onChange',\r\n\t},\r\n\tonInput: function(e) {\r\n\t\tthis.model.set('value',e.currentTarget.value);\r\n\t},\r\n\tonChange: function(e) {\r\n\t\tthis.model.set('value',e.currentTarget.checked);\r\n\t\tlsChannel.trigger('setup:save:success',this.model.attributes);\r\n\t}\r\n});\r\nView.Settings = Marionette.CollectionView.extend({\r\n\ttagName: 'ul',\r\n\tclassName: 'list-group navibar-pad',\r\n\tchildView: View.SettingItem,\r\n\tinitialize: function (options) {\r\n\t\tthis.collection = new Data.Settings(options.dataset);\r\n\t\tconsole.log(this.collection);\r\n\t\tthis.bindEvents(app.model,this.accelerometerModelEvents);\r\n\t},\r\n\tcollectionEvents: {\r\n\t\t'change' : 'onModelChange'\r\n\t},\r\n\taccelerometerModelEvents: {\r\n\t\t'change' : 'onGravityChange'\r\n\t},\r\n\tonModelChange: function() {\r\n\t\tconsole.log('saved')\r\n\t\tlocalSave('settings',this.collection.models);\r\n\t},\r\n\tonGravityChange: function(model) {\r\n\t\tx = model.get('gravity').x*9/2;\r\n\t\ty = model.get('gravity').y*16/2;\r\n\t\tif (Math.abs(x) > 10/9 && Math.abs(y) > 10/16) {\r\n\t\t\tthis.$el.css({\r\n\t\t\t\ttransform: 'translate3d('+x+'px, '+y+'px,0)',\r\n\t\t\t\t// transform: 'translate3d('+x+'px, '+y+'px,0) rotateX('+y/5+'deg) rotateY('+x/5+'deg)',\r\n\t\t\t\t// transform: 'rotateX('+y+'deg) rotateY('+x+'deg) rotateZ('+x+'deg)',\r\n\t\t\t})\r\n\t\t}\r\n\t}\r\n\r\n});\r\n\r\nwindow.Setup = {\r\n\tView: View,\r\n\tData: Data,\r\n\tEntry: EntryPoint\r\n}\r\n\r\n}());"],"sourceRoot":"/source/"}