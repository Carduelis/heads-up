{"version":3,"sources":["js/main.js"],"names":["RegionSetter","this","arguments","length","_","isArray","prototype","builder","regions","i","regionName","prefix","replaceElement","el","configAntiCache","random","configGetter","callback","window","config","$","getJSON","AcceleratorData","Backbone","Model","extend","defaults","y","x","z","alpha","beta","gamma","gravity","App","Marionette","Application","region","initialize","log","options","onStart","model","console","getRegion","RootView","app","on","e","start","checkVersion","history","dataset","DeviceMotionEvent","ondevicemotion","accelerationIncludingGravity","set","AcceleratorDebug","View","_Marionette$View$exte","template","className","modelEvents","change","_defineProperty","triggerMethod","Date","getTime","lastRenderTime","getNow","delta","render","onRender","localHas","show","Navibar","document","Sound","ToggleView","ready"],"mappings":"gKAAIA,aAAe,WAElB,MADAC,MAAKC,UAAYA,UACY,GAAzBD,KAAKC,UAAUC,QAAeC,EAAEC,QAAQJ,KAAKC,UAAU,MAC1DD,KAAKC,UAAYA,UAAU,IAF5BD,KAAKC,OAAL,KACID,KAAKC,UAGTF,cAAAM,UAAAC,QAAA,WACAC,UAND,KAAA,GAAAC,KAAAR,MAAAC,UAAA,CAYE,GAAIQ,GAAaT,KAAKC,UAAUO,EAHlCT,SAAAA,IACCQ,GAAAA,KAAUG,OAAVD,EACAE,gBAAc,GAGZC,MAAIL,SAGL,IAAAM,iBAAAV,EAAAW,OAAA,EAAA,KACDC,aAAA,SAAAC,GATDC,OAAAC,OAsBIF,EAPFC,OAAAC,QAAAC,EAAEC,QAAQ,sBAAsBP,iBAH9BA,QAAAA,SAAAA,GACAE,OAAAA,OAAeG,EAClBF,EAAYE,KAGTD,KAAAA,SAAgBC,GAChBF,MAAAA,uCALJK,gBAAAC,SAAAC,MAAAC,QAgBCC,SAAU,WADX,OACCA,EAAAA,EACCC,EAAA,EACCC,EAAG,EACHD,MAFM,EAGNE,KAHM,EAINC,MAAO,EACPC,SACAC,EAAAA,EACAC,EAAAA,EACCL,EAAG,OAVPM,IAAAC,WAAAC,YAAAX,QAmBCY,OAAQ,OADTC,WAAUH,SAAWC,GACpBC,QAAQE,IAAA,cAD+BC,GAEvCF,KAAAA,MAAY,GAAAhB,kBAEXmB,QAAKC,WAJiCC,QAAAJ,IAAAtC,KAAA2C,aAMvCH,KAAAA,SAAS,GAAAI,WACRF,MAAQJ,KAAIG,QAEXA,KAAAA,YAAYA,KAAAA,KAAAA,YAGbI,KAAA,GAAAZ,KAZsCY,IAAxCC,GAAA,QAAA,SAAAC,GAcAF,SAAUZ,QAAVe,QACAH,aAAAI,cACC,mBAASC,QAAQF,oBACjBjC,OAAAA,eAAA,SAAAgC,GACA,GAAII,GAAOlC,EAAOmC,UAAAA,EAAAA,aACjBnC,GAAOoC,QAAAA,EAAPC,6BACKH,EAAAA,cACJA,EAAAA,OAAQnB,EAAUe,EAAEO,cAGnBT,IAAAJ,MAAAc,IAAAJ,MAaJ,IAAIK,kBAAmBtB,WAAWuB,KAAKjC,QAAhBkC,uBAAvBC,SAAIH,uBACHG,UAAU,YACVC,WAAW,SAAArB,GACXF,KAAAA,MAAYE,EAAAE,OAEXoB,aAEAC,OAAA,WAPqBC,gBAAAL,sBAAA,aAMT,WANS1D,KAAAgE,cAAA,qBAAAD,gBAAAL,sBAAA,SAAA,WAcrB,OAAO,GAAIO,OAAOC,YAdGH,gBAAAL,sBAAA,kBAiBhBS,WAjBgBnE,KAAAmE,eAAAnE,KAAAoE,WAAAL,gBAAAL,sBAAA,cAqBT,WACX,GAAAW,GAAArE,KAAAoE,SAAApE,KAAAmE,cACAE,GAAA,KAvBoBrE,KAAAsE,WAAAP,gBAAAL,sBAAA,iBA6BRxB,WACdyB,KAAAA,cADqC,qBA7BfD,wBAiCtBrB,SAAYH,WAAAuB,KAAAjC,QACXmC,SAAKlB,UACLmB,UANoC,OAOrCW,QAAAA,GAAUxE,cAAA,UAAY,YAAA,UAAA,OAAA,SAAA,SACrBsC,WAAImC,SAAAjC,GACHvC,KAAAyC,MAAKE,EAAUF,OAAuC8B,SAAtD,WAGAC,SAAA,UACDxE,KAAK2C,UAAU,aAAW8B,KAAK,GAAIC,mBACnCjC,MAAKE,KAALF,SADAzC,KAAK2C,UAAU,WAAW8B,KAAK,GAAIC,SAAQjB,MAM3CkB,KAAAA,UAAF,SAAkBF,KAAY,GAAAG,OAAAC,cAA9B1D,GAAEwD,UAAUG,MAAM,WACjBjC,IAAIG","file":"main.js","sourcesContent":["var RegionSetter = function() {\r\n\tthis.arguments = arguments;\r\n\tif (this.arguments.length == 1 && _.isArray(this.arguments[0])) {\r\n\t\tthis.arguments = arguments[0]\r\n\t}\r\n\tthis.prefix = 'r-';\r\n\treturn this.builder();\r\n};\r\n\r\nRegionSetter.prototype.builder = function() {\r\n\tregions = {};\r\n\tfor (var i in this.arguments) {\r\n\t\tvar regionName = this.arguments[i]\r\n\t\tregions[regionName] = {\r\n\t\t\tel: this.prefix+regionName,\r\n\t\t\treplaceElement: true\r\n\t\t}\r\n\t}\r\n\treturn regions\r\n};\r\n\r\nvar configAntiCache = _.random(0,100000);\r\nvar configGetter = function(callback) {\r\n\tif (!window.config) {\r\n\t\t$.getJSON('assets/config.json?'+configAntiCache)\r\n\t\t\t.success(function(config){\r\n\t\t\t\twindow.config = config;\r\n\t\t\t\tcallback(config);\r\n\t\t\t})\r\n\t\t\t.fail(function (json) {\r\n\t\t\t\talert('Can not reach configuration-file');\r\n\t\t\t})\r\n\t} else {\r\n\t\tcallback(window.config);\r\n\t}\r\n};\r\n\r\nvar AcceleratorData = Backbone.Model.extend({\r\n\tdefaults: function() {\r\n\t\treturn {\r\n\t\t\tx: 0,\r\n\t\t\ty: 0,\r\n\t\t\tz: 0,\r\n\t\t\talpha: 0,\r\n\t\t\tbeta: 0,\r\n\t\t\tgamma: 0,\r\n\t\t\tgravity: {\r\n\t\t\t\tx: 0,\r\n\t\t\t\ty: 0,\r\n\t\t\t\tz: 0,\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n});\r\n\r\nvar App = Marionette.Application.extend({\r\n\tregion: '#app',\r\n\tinitialize: function(options) {\r\n\t\tconsole.log('My options:', options);\r\n\t\tthis.model = new AcceleratorData();\r\n\t},\r\n\tonStart: function() {\r\n\t\tconsole.log(this.getRegion());\r\n\t\tthis.rootView = new RootView({\r\n\t\t\tmodel: this.model\r\n\t\t});\r\n\t\tthis.getRegion().show(this.rootView);\r\n\t},\r\n});\r\napp = new App();\r\napp.on('start', (e) => {\r\n\tBackbone.history.start();\r\n\tconfigGetter(checkVersion);\r\n\tif (typeof window.DeviceMotionEvent !== 'undefined') {\r\n\t\twindow.ondevicemotion = function(e) {\r\n\t\t\tvar dataset = _.extend({},e.acceleration);\r\n\t\t\tdataset.gravity = e.accelerationIncludingGravity;\r\n\t\t\tif (e.rotationRate) {\r\n\t\t\t\t_.extend(dataset,e.rotationRate);\r\n\t\t\t};\r\n\t\t\t// _.delay(()=>{\r\n \t\t\t\tapp.model.set(dataset);\r\n\t\t\t// },100);\r\n\t\t\t\r\n\t\t}\r\n\t};\r\n\t// if (window.DeviceOrientationEvent) {\r\n\t// \twindow.addEventListener('deviceorientation', deviceOrientationHandler, false);\r\n\t\t\r\n\t// }\r\n});\r\n\r\nvar AcceleratorDebug = Marionette.View.extend({\r\n\ttemplate: '#t-accelerator-debug',\r\n\tclassName: 'acc-debug',\r\n\tinitialize: function(options) {\r\n\t\tthis.model = options.model;\r\n\t},\r\n\tmodelEvents: {\r\n\t\t// 'change': 'checkRender',\r\n\t\t'change': 'render'\r\n\t},\r\n\tinitialize: function() {\r\n\t\tthis.triggerMethod('set:render:time');\r\n\t},\r\n\tgetNow: function() {\r\n\t\treturn new Date().getTime()\r\n\t},\r\n\tonSetRenderTime: function() {\r\n\t\tthis.lastRenderTime = this.getNow();\r\n\t},\r\n\tcheckRender: function() {\r\n\t\tvar delta = this.getNow() - this.lastRenderTime;\r\n\t\tif (delta > 100) {\r\n\t\t\tthis.render();\r\n\t\t}\r\n\t},\r\n\tonBeforeRender: function() {\r\n\t\tthis.triggerMethod('set:render:time')\r\n\t}\r\n})\r\nvar RootView = Marionette.View.extend({\r\n\ttemplate: '#t-root',\r\n\tclassName: 'root',\r\n\tregions: new RegionSetter('navibar','statusbar','content','test','footer','sound'),\r\n\tinitialize: function(options) {\r\n\t\tthis.model = options.model;\r\n\t},\r\n\tonRender: function () {\r\n\t\tif (localHas('debug')) {\r\n\t\t\tthis.getRegion('statusbar').show(new AcceleratorDebug({\r\n\t\t\t\tmodel: this.model\r\n\t\t\t}));\r\n\t\t}\r\n\t\tthis.getRegion('navibar').show(new Navibar.View());\r\n\t\tthis.getRegion('sound').show(new Sound.ToggleView());\r\n\t}\r\n});\r\n\r\n\r\n$(document).ready(function () {\r\n\tapp.start();\r\n\r\n});\r\n\r\n\r\n\r\n\r\n"]}