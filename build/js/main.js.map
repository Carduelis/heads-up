{"version":3,"sources":["js/main.js"],"names":["RegionSetter","this","arguments","length","_","isArray","prototype","builder","regions","i","regionName","prefix","replaceElement","el","AcceleratorData","Backbone","Model","extend","defaults","x","y","alpha","z","beta","gamma","App","Marionette","Application","region","initialize","options","console","log","getRegion","model","rootView","app","on","e","history","start","checkVersion","DeviceMotionEvent","ondevicemotion","acceleration","rotationRate","window","AcceleratorDebug","View","_Marionette$View$exte","template","className","change","_defineProperty","triggerMethod","getTime","lastRenderTime","getNow","delta","render","onRender","show","Navibar","Sound","ToggleView","$","document","ready"],"mappings":"gKAAIA,aAAe,WAElB,MADAC,MAAKC,UAAYA,UACY,GAAzBD,KAAKC,UAAUC,QAAeC,EAAEC,QAAQJ,KAAKC,UAAU,MAC1DD,KAAKC,UAAYA,UAAU,IAF5BD,KAAKC,OAAL,KACID,KAAKC,UAERF,cAAAM,UAAAC,QAAA,WACDC,UACA,KAAA,GAAOC,KAAKF,MAALL,UAAP,CAND,GAAAQ,GAAAT,KAAAC,UAAAO,EAQAT,SAAAA,IACCQ,GAAAA,KAAUG,OAAVD,EACAE,gBAAc,GAGZC,MAAIL,SADiB,IAAtBM,iBAAAC,SAAAC,MAAAC,QAIAC,SAAA,WACD,OATDC,EAAA,EAWAC,EAAIN,EACHI,EAAAA,EACCG,MAAO,EACNF,KADM,EAENC,MAFM,EAGNE,SACAD,EAAAA,EACAE,EAAAA,EACAC,EAAAA,OANDC,IAAAC,WAAAC,YAAAV,QAaAW,OAAA,OAfoBC,WAAtB,SAAAC,GAqBEC,QAAQC,IAAI,cAAeF,GAH7B7B,KAAIwB,MAAMC,GAAAA,kBAETG,QAAAA,WACCE,QAAQC,IAAI/B,KAAAgC,aACZhC,KAAKiC,SAAQ,GAAIpB,WAJqBoB,MAAAjC,KAAAiC,QAOtCH,KAAAA,YAAiBE,KAAAA,KAALE,YACiBC,KAA7B,GAAAX,KAGAW,IAAAC,GAAKJ,QAAL,SAAAK,GACAvB,SAAAwB,QAAAC,QAZQC,eAcV,mBAAUhB,QAAViB,oBACAN,OAAOO,eAAUL,SAAMA,GACtBvB,GAAAA,GAAAX,EAAiBoC,UAAjBF,EAAAM,aACAH,GAAAA,QAAAA,EAAAA,6BACIH,EAAAO,cACHC,EAAAA,OAAOH,EAAAA,EAAPE,cAGCT,IAAMS,MAAAA,IAAAA,MAYR,IAAAE,kBAAArB,WAAAsB,KAAA/B,QAAAgC,uBAnBDC,SAAA,uBAwBCC,UAAW,YAFZtB,WAAIkB,SAAAA,GACHG,KAAAA,MAAUpB,EAAAI,OAEVL,aAHsBuB,OAAA,WAHtBC,gBAAAJ,sBAAA,aAUC,WACAhD,KAAAqD,cAAU,qBAXXD,gBAAAJ,sBAAA,SAGsB,WAWrB,OAAKK,GAAAA,OAAcC,YAdpBF,gBAAAJ,sBAAA,kBAiBQ,WAdchD,KAAAuD,eAAAvD,KAAAwD,WAHtBJ,gBAAAJ,sBAAA,cAGsB,WAoBrB,GAAIS,GAAQzD,KAAKwD,SAAWxD,KAAKuD,cAC7BE,GAAQ,KACXzD,KAAK0D,WAzBPN,gBAAAJ,sBAAA,iBA6BMK,WA1BgBrD,KAAAqD,cAAA,qBAHtBL,wBAkCAE,SAAWzB,WAF0BsB,KAAA/B,QAGrCT,SAAS,UACTqB,UAAAA,OACCrB,QAAK0B,GAALlC,cAAqBkC,UAArB,YAAA,UAAA,OAAA,SAAA,SACAL,WANoC,SAAAC,GAOrC8B,KAAAA,MAAU9B,EAAAI,OAER0B,SAAK3B,WACJC,SAAO,UAD8CjC,KAAtDgC,UAAA,aAAA4B,KAAA,GAAAd,mBAGAb,MAAAjC,KAAAiC,SAGDjC,KAAAgC,UAAA,WAAA4B,KAAA,GAAAC,SAAAd,MAfF/C,KAAAgC,UAAA,SAAA4B,KAAA,GAAAE,OAAAC,cAmBAC,GAAEC,UAAUC,MAAM,WACjB/B,IAAII","file":"main.js","sourcesContent":["var RegionSetter = function() {\r\n\tthis.arguments = arguments;\r\n\tif (this.arguments.length == 1 && _.isArray(this.arguments[0])) {\r\n\t\tthis.arguments = arguments[0]\r\n\t}\r\n\tthis.prefix = 'r-';\r\n\treturn this.builder();\r\n};\r\nRegionSetter.prototype.builder = function() {\r\n\tregions = {};\r\n\tfor (var i in this.arguments) {\r\n\t\tvar regionName = this.arguments[i]\r\n\t\tregions[regionName] = {\r\n\t\t\tel: this.prefix+regionName,\r\n\t\t\treplaceElement: true\r\n\t\t}\r\n\t}\r\n\treturn regions\r\n};\r\nvar AcceleratorData = Backbone.Model.extend({\r\n\tdefaults: function() {\r\n\t\treturn {\r\n\t\t\tx: 0,\r\n\t\t\ty: 0,\r\n\t\t\tz: 0,\r\n\t\t\talpha: 0,\r\n\t\t\tbeta: 0,\r\n\t\t\tgamma: 0,\r\n\t\t\tgravity: {\r\n\t\t\t\tx: 0,\r\n\t\t\t\ty: 0,\r\n\t\t\t\tz: 0,\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n});\r\n\r\nvar App = Marionette.Application.extend({\r\n\tregion: '#app',\r\n\tinitialize: function(options) {\r\n\t\tconsole.log('My options:', options);\r\n\t\tthis.model = new AcceleratorData();\r\n\t},\r\n\tonStart: function() {\r\n\t\tconsole.log(this.getRegion());\r\n\t\tthis.rootView = new RootView({\r\n\t\t\tmodel: this.model\r\n\t\t});\r\n\t\tthis.getRegion().show(this.rootView);\r\n\t},\r\n});\r\napp = new App();\r\napp.on('start', (e) => {\r\n\tBackbone.history.start();\r\n\tcheckVersion();\r\n\tif (typeof window.DeviceMotionEvent !== 'undefined') {\r\n\t\twindow.ondevicemotion = function(e) {\r\n\t\t\tvar dataset = _.extend({},e.acceleration);\r\n\t\t\tdataset.gravity = e.accelerationIncludingGravity;\r\n\t\t\tif (e.rotationRate) {\r\n\t\t\t\t_.extend(dataset,e.rotationRate);\r\n\t\t\t};\r\n\t\t\t// _.delay(()=>{\r\n \t\t\t\tapp.model.set(dataset);\r\n\t\t\t// },100);\r\n\t\t\t\r\n\t\t}\r\n\t};\r\n\t// if (window.DeviceOrientationEvent) {\r\n\t// \twindow.addEventListener('deviceorientation', deviceOrientationHandler, false);\r\n\t\t\r\n\t// }\r\n});\r\n\r\nvar AcceleratorDebug = Marionette.View.extend({\r\n\ttemplate: '#t-accelerator-debug',\r\n\tclassName: 'acc-debug',\r\n\tinitialize: function(options) {\r\n\t\tthis.model = options.model;\r\n\t},\r\n\tmodelEvents: {\r\n\t\t// 'change': 'checkRender',\r\n\t\t'change': 'render'\r\n\t},\r\n\tinitialize: function() {\r\n\t\tthis.triggerMethod('set:render:time');\r\n\t},\r\n\tgetNow: function() {\r\n\t\treturn new Date().getTime()\r\n\t},\r\n\tonSetRenderTime: function() {\r\n\t\tthis.lastRenderTime = this.getNow();\r\n\t},\r\n\tcheckRender: function() {\r\n\t\tvar delta = this.getNow() - this.lastRenderTime;\r\n\t\tif (delta > 100) {\r\n\t\t\tthis.render();\r\n\t\t}\r\n\t},\r\n\tonBeforeRender: function() {\r\n\t\tthis.triggerMethod('set:render:time')\r\n\t}\r\n})\r\nvar RootView = Marionette.View.extend({\r\n\ttemplate: '#t-root',\r\n\tclassName: 'root',\r\n\tregions: new RegionSetter('navibar','statusbar','content','test','footer','sound'),\r\n\tinitialize: function(options) {\r\n\t\tthis.model = options.model;\r\n\t},\r\n\tonRender: function () {\r\n\t\tif (localHas('debug')) {\r\n\t\t\tthis.getRegion('statusbar').show(new AcceleratorDebug({\r\n\t\t\t\tmodel: this.model\r\n\t\t\t}));\r\n\t\t}\r\n\t\tthis.getRegion('navibar').show(new Navibar.View());\r\n\t\tthis.getRegion('sound').show(new Sound.ToggleView());\r\n\t}\r\n});\r\n\r\n\r\n$(document).ready(function () {\r\n\tapp.start();\r\n\r\n});\r\n\r\n\r\n\r\n\r\n"]}